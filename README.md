### TopicSearcherAI

Консольное приложение для автоматического поиска информации по заданной теме. Результаты поиска записываются в Word документ и сохраняются на рабочий стол пользователя.

Поиск и генерация информации осуществляется моделью GigaChat.

Не является инструментом для полноценной генерации документов. Требуется ручная доработка, поскольку:
- Плохо работает с математическими темами - отображает формулы в LaTeX виде.
- Нет готовых шаблонов оформления - списков, стилей, нумерации.
- Отсутствую рисунки, таблицы, графики, или другие формы мультимедиа.
- Иногда могут оставаться отступы между абзацами или некоторые символы markdown разметки.
- Другие проблемы, связанные с ИИ генерацией и переносе ответов в Word.

### Быстрый старт
I) Установить API ключ от GigaChat API через консольную команду `--key set <your_key>`. 

II) Установить тему `--theme set <your_theme>`.

III) Выполнить поиск всех подтем и сгенерировать отчет `--build`.

<img width="701" height="441" alt="preview_quick_start" src="https://github.com/user-attachments/assets/a68497a8-aced-4f0a-b634-c1c57f9ece60" />

Подробнее о командах быстрого старта:
- `--key set <your_key>` устанавливает ключ для соединения с GigaChat моделью.
- При установке темы `--theme set <your_theme>` происходит разбиение значения theme на подтемы в формате 1, 1.1, ... (подробнее в `--list`).
- Команда `--build` запускает алгоритм обхода массива подтем и алгоритм генерации информации по каждой подтеме моделью GigaChat.
  Все результаты объединяются в итоговую строку, которая добавляется в Word документ и сохраняется на рабочий стол (подробнее о параметрах модели и документа в `--detail`).

### Сертификация и API ключ
При первом запуске приложения всплывает окно установки сертификата от НУЦ Минцифры ([самостоятельная установка](https://www.gosuslugi.ru/crt)). Без этого сертификата подключение к GigaChat, даже при наличии ключа, будет приводить к ошибке SSL сертификации.
Сертификат устанавливается в корневое хранилище сертификатов пользователя.

Для удаления сертификата:
- Оснастка certmgr
  - Win + R =>
  - certmgr.msc =>
  - Доверенные корневые центры сертификации =>
  - Сертификаты =>
  - Russian Trusted Root CA =>
  - ПКМ по сертификату =>
  - Удалить.
- PowerShell
  - Ввод `Get-ChildItem Cert:\CurrentUser\Root | Where-Object { $_.Subject -like "*Russian Trusted Root CA*" } | Format-List Subject, Thumbprint` =>
  - Ввод `Get-ChildItem Cert:\CurrentUser\Root | Where-Object { $_.Thumbprint -eq "your_trumbprint" } | Remove-Item`.

API ключ к модели GigaChat генерируется в настройках вашего [API проекта](https://developers.sber.ru/portal/gigachat-and-api) на оф. странице.
Установленный ключ `--key set <your_key>` сохраняется в переменные среды пользователя.

Для добавление/удаления ключа вручную:
- Апплет sysdm
  - Win + R =>
  - sysdm.cpl =>
  - Дополнительно =>
  - Переменные среды =>
  - Создать/Изменить/Удалить для окна "Переменные среды пользователя".
- CMD
  - Ввод для установки `setx KEY_BUILDER "your_key"`.
  - Ввод для удаления `reg delete HKCU\Environment /v KEY_BUILDER /f`.
- PowerShell
  - Ввод для установки `[System.Environment]::SetEnvironmentVariable("KEY_BUILDER", "your_key", "User")`.
  - Ввод для удаления `[System.Environment]::SetEnvironmentVariable("KEY_BUILDER", $null, "User")`.

### Команды
- Основное
  - `--help` - получить список команд
  - `--detail` - получить список переменных
  - `--key set <value>` - установить API ключ к GigaChat
  - `--theme accessor <value>` - установить/получить искомую тему
  - `--list` - получить декомпозицию темы
  - `--take accessor <value>`  - установить/получить значение переменной охвата
  - `--build` - выполнить поиск информации и сформировать отчет
  - `--default` - вернуться к заводским настройкам
- GigaChat модель
  - `--model accessor <value>` - установить/получить AI модель
  - `--temperature accessor <value>` - установить/получить температуру ответа
  - `--topP accessor <value>` - установить/получить topP параметр
  - `--maxTokens accessor <value>` - установить/получить количество токенов
- Word параметры
  - `--doc.format accessor <value>` - установить/получить формат документа
  - `--doc.margin accessor <left; top; right; bottom>` - установить/получить отступы от краев листа
  - `--doc.aligment accessor <value>` - установить/получить формат выравнивания
  - `--doc.firstLine accessor <value>` - установить/получить отступ первой строки
  - `--doc.spacing accessor <value>` - установить/получить межстрочный интервал
  - `--doc.family accessor <value>` - установить/получить шрифт документа
  - `--doc.size accessor <value>` - установить/получить размер шрифта
